generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("DATABASE_URL")
}

model User {
  id             String     @id @default(auto()) @map("_id") @db.ObjectId
  name           String
  email          String     @unique
  hashedPassword String?
  image          String?
  role           Role       @default(CUSTOMER)
  address        String?  
  phone          String?
  createdAt      DateTime   @default(now())
  comments       Comment[]
  activities     Activity[] // Kullanıcıya ait aktiviteler
}

model Activity {
  id          String   @id @default(auto()) @map("_id") @db.ObjectId
  user        User     @relation(fields: [userId], references: [id])
  userId      String   @db.ObjectId
  type        ActivityType
  referenceId String?  @db.ObjectId // İlgili modelin ID'si (Comment, Supplement vb.)
  productName String?
  description String
  date        DateTime @default(now())
  metadata    Json?    // Ekstra bilgiler için esnek alan
}

model Supplement {
  id          String    @id @default(auto()) @map("_id") @db.ObjectId
  name        String
  description String
  price       Float
  stock       Int       @default(0)
  imageUrl    String
  category    Category?
  createdAt   DateTime  @default(now())
  updatedAt   DateTime  @default(now()) @updatedAt
  comments    Comment[]
}

model Comment {
  id           String    @id @default(auto()) @map("_id") @db.ObjectId
  supplement   Supplement @relation(fields: [supplementId], references: [id])
  supplementId String     @db.ObjectId
  user         User       @relation(fields: [userId], references: [id])
  userId       String     @db.ObjectId
  content      String
  rating       Int       @default(5)
  createdAt    DateTime  @default(now())
}

enum Role {
  CUSTOMER
  DOCTOR
  ADMIN
}

enum ActivityType {
  PASSWORD_CHANGE
  PROFILE_UPDATE
  PHONE_UPDATE
  ADDRESS_UPDATE
  LOGIN
  LOGOUT
  ORDER_CREATE
  ORDER_CANCEL
  COMMENT_ADD
  COMMENT_EDIT
  COMMENT_DELETE
  PRODUCT_VIEW
}

enum Category {
  BRAIN
  WOMEN_HEALTH
  MENS_HEALTH
  HEART
  SLEEP
  ENERGY
}